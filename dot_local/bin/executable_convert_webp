#!/usr/bin/env python3
"""Convert WebP images to PNG using ImageMagick."""

import subprocess
import sys
from pathlib import Path

from j_lib import JParser

parser = JParser(description="Convert WebP images to PNG")
parser.add_argument("input_file", type=Path, help="WebP file to convert")
parser.add_argument(
    "--format", "-f", default="png", choices=["png", "jpg", "tiff"],
    help="Output format",
)
args = parser.run()

if not args.input_file.exists():
    print(f"Error: {args.input_file} does not exist", file=sys.stderr)
    sys.exit(1)

output = args.input_file.with_suffix(f".{args.format}")
subprocess.run(["convert", str(args.input_file), str(output)], check=True)
print(f"Converted {args.input_file} to {output}")
